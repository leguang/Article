# 中后台管理系统设计

由于之前开发资源有限，运营/管理人员在工作期间总是出现如下情况：

![](https://i.imgur.com/1h5ScQr.png) 

这样一来效率极低，大大增加运营人员负担和开发人员重复体力劳作几率，用户体验也不好，现在要求出一套管理系统来配合解决用户的问题，让用户快速得到反馈，同时为了更方便的开展和运营业务，决定启动一个后台管理系统计划，目的是为了让部分功能对外暴露，使运营和管理人员能参与到后台数据的处理，同时为管理人员赋予一定的决策权，以达到减轻开发人员负担的作用。

## 要求

对于后台管理系统，界面就不要求有多好看，只需要简介易用，快速响应就行，**因此这部分就直接取模板的默认样式，不出设计稿了，熊老师觉得怎么好看怎么来，纯自由发挥。**提出以下几点要求：

#### 安全

安全性放在第一位，是因为这个系统是针对用户的数据直接操作，因此要求严格，要求如下：

- 不允许删除数据，所有的操作都只是对可行性的标记字段的操作。
- 要求记录该次操作的人员信息，考虑到代码入侵性，看是仅仅记录操作人员的操作日志，还是记录每次操作所对应的人员信息，待商议。
- 只允许公司指定人员有权限操作，其他人不得操作。
- 只允许在公司内部操作，不允许外网操作。
- 操作要针对测试环境和正式环境（比如要推送一个广告，在测试环境中先推送试试效果），默认是正式环境。

#### 易用

易用是指：用户反馈问题-->我们解决问题-->用户得到问题反馈，这一过程的简单易用。能让代码处理的就不需要开发人员再去处理，一旦有开发参与了，那必定会是重复劳作。比如在App端有一个反馈界面（类似IM），直接以对话的形式反馈到后台，后台统一回复，甚至做成机器人的自动回复+人工回复。能做成一键式的决不多步操作，能做成傻瓜式的，决不浪费脑细胞。

#### 智能

需要提供决策，能让运营/管理人员做选择题的，就不要他做填空题，提供尽可能多的信息展示和建议。

## 功能大纲

![](https://i.imgur.com/Rfzr6ki.png) 

暂时只罗列出这么多功能，后续有想到再加。

**暂时我们只运营了摩尔钱包，所以以下功能如无特别说明，均针对的是摩尔钱包功能。**

## 模板

考虑到熊老师专心研究Vue，因此综合考虑后，选择vue-element-admin这个模板

> https://panjiachen.github.io/vue-element-admin/#/dashboard

![后台](https://i.imgur.com/IjedCiY.png) 

默认一进来展示的内容是一些常见的、易查询的数据，如下：

- 当前在线人数（后期考虑做成根据时间的线形图统计）。
- 使用手册。
- 公司成员的联系方式。

左边导航从上至下，一级分类及其对应的子功能如下：

| 一级分类   | 子功能                                                       |
| ---------- | ------------------------------------------------------------ |
| 1.用户     | 1.查询<br />2.用户黑名单<br />3.IP地址黑名单                 |
| 2.配置     | 1.摩尔钱包文案<br />2.Banner列表 <br />3.红包列表<br />4.发现模块<br />5.我的模块 |
| 3.通知     | 1.通知<br />2.历史记录                                       |
| 4.推送     | 1.广告<br />2.连接管理<br />3.历史记录                       |
| 5.版本升级 | 1.Android<br />2.iOS                                         |
| 6. 打款    | 无                                                           |
| 7.日志     | 无                                                           |
| 8.使用手册 | 无                                                           |
| 9.反馈     | 无                                                           |

## 功能

### 测试环境和正式环境的切换

针对后台系统的所有功能都是有测试环境和正式环境区分的，默认是正式环境，这个是针对某些需要测试的功能设计的，比如推送广告，需要看一下效果，因此需要先在测试环境配好，测试通过再直接用正式环境操作。所以考虑在页面顶部有一个开关，点击一下就切换到另一种模式。

## 用户

用户模块的主要功能其实就是增删改查和黑名单等，界面没要求，根据功能和经验合理呈现即可，功能如下：

| 功能描述     |                                                              |
| ------------ | ------------------------------------------------------------ |
| 查询         | 各种查询：<br />1.根据手机号码查询出用户的信息列表<br />2.根据用户MOL积分币的累积量查询用户的信息列表<br />3.根据用户MOL积分币的可提取余额查询用户的信息列表<br />4.其他<br />**这部分由何流远负责，具体还需要哪些查询功能再想想，觉得有意义的就加上去** |
| 用户黑名单   | 要求在界面上列出用户黑名单列表，每一条列表可以单独控制封禁和解封功能，同时要求有条件查询的选择，比如根据手机号码查询筛选列表 |
| IP地址黑名单 | 要求在界面上列出IP地址黑名单列表，一点这个IP地址就可以呈现出该IP地址下的用户列表 |

## 配置

该功能是对界面的一系列控制，**这部分交由顺义来负责**，由于涉及到界面控制，因此严格要求对测试环境和正式环境，在界面上也要有相关提示，比如在填写完配置信息，点提交的时候，要求弹框警示运营人员。功能如下表所示：

| 功能         | 描述                                                   |
| ------------ | ------------------------------------------------------ |
| 摩尔钱包文案 | 针对手机App的各种文案和链接，这部分对应的是content接口 |
| Banner图配置 | Banner图是指发现模块的Banner图配置                     |
| 红包列表     | 针对的是发现模块中的红包模块的红包列表配置             |
| 发现模块     | “发现”模块的功能（item）列表                           |
| 我的模块     | “我的”模块功能（item）列表                             |

## 通知

这个通知是指借助第三方平台的通知，是指手机APP的进程被杀掉后，还能收到的通知，暂时iOS对接的是极光推送，Android对接的是阿里云推送。功能如下：

| 功能     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 通知     | 填写好参数后就点击发送即可                                   |
| 历史记录 | 历史列表，要求在点击某个历史记录的时候，就跳转到通知页面，然后将该历史记录的参数都填好 |

对界面没有要求，只是填空，可以参考阿里云的，如下图所示：

![通知](https://i.imgur.com/TFm5oCj.png) 

我们把通知的JSON格式定义如下

```
{
    "data": {
        "title": "摩尔",
        "content": "摩尔",
        "when": "",
        "smallIcon": "",
        "largeIcon": "",
        "priority": "",
        "lights": "",
        "vibrate": "",
        "sound": "",
        "channel": ""
    }
}

```

因此界面上只需要出10个填空的，把这10个字段都呈现出来即可。

## 推送

这个推送与上面的通知的本质区别是：通知是在App根本没有启动的时候，依托系统级的长连接得到后台发送过来的信息，而这个推送定义成App已经启动，利用本App的长连接得到后台的推过来的信息。因此可以做更多的拓展。

| 功能     | 描述                                                         |
| -------- | ------------------------------------------------------------ |
| 广告     | 这部分暂时只考虑定义一个Web模板广告（本来是有计划一个原生的模板弹窗和一个Web模板弹窗来显示广告的，但是原生模板弹窗暂时没想好，因此不考虑了），填写一个某网页的url（这个可能是熊老师写个某个活动Web页面），然后指定发给某个用户，或者发给全部用户，用户拿到这个url后会拼接好token启动该url对应的web，因此这里还可以做一些针对用户的扩展，比如做个调查问卷，填写过问卷的给予MOL奖励，此时token就起作用了。界面只需要几个输入框即可。 |
| 历史记录 | 历史列表，要求在点击某个历史记录的时候，就跳转到广告页面，然后将该历史记录的参数都填好 |
| 连接管理 | 针对每一个长连接有一个开关，后台可控制允许某个/某些用户连接还是断开。 |

## 版本升级（暂时不做，等重构好升级接口再实现）

现在的这种手动上传到某个阿里云目录的做法是比较原始的，应该有一个统一的管理版本的地方，发布版本时也应该是简单的在后台填写日志信息，然后发布，而不是手动修改数据库。

| 功能    | 描述                                       |
| ------- | ------------------------------------------ |
| Android | 界面上只要求将新版的JSON数据模拟得出来即可 |
| iOS     | 界面上只要求将新版的JSON数据模拟得出来即可 |

界面上可以参考Bugly

![](https://i.imgur.com/lsFT9Nx.png) 

## 打款（暂时不考虑）

这个功能可以暂时不考虑

## 日志

对该后台的所有操作都应该有记录，比如什么时候，那个人员登录过后台管理系统，做过哪些操作，根据时间排序列出来，方便日后审查和追责。

## 使用手册

这部分简单介绍即可，可以把这边文档当做简版使用手册。

## 反馈（暂时不考虑）

这部分是重点，希望后台能做成阿里云那么强大的服务后台。到时候前端会有一个反馈入口，以对话形式展示在前端App的某个页面，用户输入疑问后，会自动回复一些提示性语言，我们的客服人员上班后会查看，看到留言列表可以直接点击某一条留言，会一个输入框，输入完文字后点击回复按钮即可完成留言，用户下次打开反馈界面后就可以看到客服回复的内容。

---

草稿:

赖慧明推荐：http://cn.inspinia.cn/graph_morris.html

熊老师推荐：https://panjiachen.github.io/vue-element-admin/#/dashboard

本人推荐：https://preview.pro.ant.design/#/dashboard/analysis
